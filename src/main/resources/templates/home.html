<!DOCTYPE html>
<html lang="fr"
      xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
<head>
    <meta charset="UTF-8"/>
    <title>PayMyBuddy – Accueil</title>
    <link rel="stylesheet" th:href="@{/css/style.css}" />
</head>
<body>

<header>
    <sec:authorize access="isAuthenticated()">
        <h1>Bonjour <sec:authentication property="name"/> !</h1>
        <p><a th:href="@{/logout}">Se déconnecter</a></p>
    </sec:authorize>

    <sec:authorize access="!isAuthenticated()">
        <h1>Bienvenue chez PayMyBuddy</h1>

    </sec:authorize>
    <hr/>
</header>

<main>
    <!-- Contenu uniquement pour les utilisateurs authentifiés -->
    <sec:authorize access="isAuthenticated()">
        <!-- SECTION MES TRANSACTIONS -->
        <section>
            <h2>Mes transactions envoyées</h2>
            <table>
                <caption>Liste de mes transactions envoyées</caption>
                <thead>
                <tr>
                    <th scope="col">ID</th>
                    <th scope="col">Destinataire (email)</th>
                    <th scope="col">Description</th>
                    <th scope="col">Montant en Euro</th>
                </tr>
                </thead>
                <tbody>
                <tr th:each="tx : ${txList}">
                    <td th:text="${tx.id}">1</td>
                    <td th:text="${tx.receiverEmail}">ami@mail.com</td>
                    <td th:text="${tx.description}">Paiement</td>
                    <td th:text="${tx.amount}">100.00</td>
                </tr>
                </tbody>
            </table>
            <p>
                <a th:href="@{/transactions/new}">
                    <span aria-hidden="true">➕</span>
                    <span>Nouvelle transaction</span>
                </a>
            </p>
        </section>

        <!-- SECTION MES CONNEXIONS -->
        <section>
            <h2>Mes connexions</h2>
            <table>
                <caption>Liste de mes connexions</caption>
                <thead>
                <tr>
                    <th scope="col">Mon pseudo</th>
                    <th scope="col">Email de l’ami</th>
                    <th scope="col">Pseudo de l’ami</th>
                </tr>
                </thead>
                <tbody>
                <tr th:each="c : ${conns}">
                    <td th:text="${c.myUsername}">Jean</td>
                    <td th:text="${c.friendEmail}">ami@mail.com</td>
                    <td th:text="${c.friendUsername}">Sophie</td>
                </tr>
                </tbody>
            </table>
            <p>
                <a th:href="@{/connections/new}">
                    <span aria-hidden="true">➕</span>
                    <span>Ajouter une connexion</span>
                </a>
            </p>
        </section>
    </sec:authorize>
</main>

<footer>
    <hr/>
    <p>&copy; 2025 PayMyBuddy</p>
</footer>
</body>
</html>
