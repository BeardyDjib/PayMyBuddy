<!DOCTYPE html>
<html lang="fr"
      xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
<head>
    <meta charset="UTF-8"/>
    <title>PayMyBuddy â€“ Accueil</title>
    <link rel="stylesheet" th:href="@{/css/style.css}" />
</head>
<body>

<header>
    <sec:authorize access="isAuthenticated()">
        <h1>Bonjour <sec:authentication property="name"/> !</h1>
        <p><a th:href="@{/logout}">Se dÃ©connecter</a></p>

    </sec:authorize>

    <sec:authorize access="!isAuthenticated()">
        <h1>Bienvenue chez PayMyBuddy</h1>
        <p>
            <a th:href="@{/login}">ðŸ”‘ Se connecter</a> |
            <a th:href="@{/users/new}">âž• Sâ€™inscrire</a>
        </p>
    </sec:authorize>
    <hr/>
</header>

<main>
    <!-- Contenu uniquement pour les utilisateurs authentifiÃ©s -->
    <sec:authorize access="isAuthenticated()">

        <!-- SECTION MES TRANSACTIONS -->
        <section>
            <h2>Mes transactions envoyÃ©es</h2>
            <table>
                <thead>
                <tr>
                    <th>ID</th>
                    <th>Destinataire (email)</th>
                    <th>Description</th>
                    <th>Montant</th>
                </tr>
                </thead>
                <tbody>
                <tr th:each="tx : ${txList}">
                    <td th:text="${tx.id}">1</td>
                    <td th:text="${tx.receiverEmail}">ami@mail.com</td>
                    <td th:text="${tx.description}">Paiement</td>
                    <td th:text="${tx.amount}">100.00</td>
                </tr>
                </tbody>
            </table>
            <p><a th:href="@{/transactions/new}">âž• Nouvelle transaction</a></p>
        </section>

        <!-- SECTION MES CONNEXIONS -->
        <section>
            <h2>Mes connexions</h2>
            <table>
                <thead>
                <tr>
                    <th>Mon pseudo</th>
                    <th>Email de lâ€™ami</th>
                    <th>Pseudo de lâ€™ami</th>
                </tr>
                </thead>
                <tbody>
                <tr th:each="c : ${conns}">
                    <td th:text="${c.myUsername}">Jean</td>
                    <td th:text="${c.friendEmail}">ami@mail.com</td>
                    <td th:text="${c.friendUsername}">Sophie</td>
                </tr>
                </tbody>
            </table>
            <p><a th:href="@{/connections/new}">âž• Ajouter une connexion</a></p>
        </section>

    </sec:authorize>
</main>

<footer>
    <hr/>
    <p>&copy; 2025 PayMyBuddy</p>
</footer>

</body>
</html>
